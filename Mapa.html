<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mapa Territorios Lago Rapel</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    #map { height: 90vh; width: 100%; }
    .territorio-label {
      font-weight: bold;
      color: #ff0000;
      background: rgba(255,255,255,0.7);
      padding: 2px 4px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script>
  <script>
    var map = L.map('map').setView([-34.2, -71.4], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Cargar el KML Ãºnico
    omnivore.kml('territorios/Territorios LAGO RAPEL.kml')
      .on('ready', function() {
        this.eachLayer(function(layer){
          if(layer.setStyle){
            layer.setStyle({color:'#3388ff', weight:2, fillOpacity:0.5});
          }
          var name = layer.feature.properties.name || 'Territorio';
          layer.bindPopup('<b>' + name + '</b>');

          if(layer.getBounds){
            var centro = layer.getBounds().getCenter();
            L.marker(centro, {icon: L.divIcon({className:'territorio-label', html:name})})
              .addTo(map);
          }
        });
        map.fitBounds(this.getBounds());
      })
      .addTo(map);
  </script>
</body>
</html>
